#-*- mode: snakemake -*-
"""FastQC: A quality control tool for high throughput sequence data.

https://www.bioinformatics.babraham.ac.uk/projects/fastqc/
"""


def joined_pe(wildcards):
    fastq = get_processed_fastq(wildcards)
    return fastq
    
if len(config['read_geometry']) == 1:
    rule qc_fastq_fastqc:
        input:
            fastq = get_processed_fastq
        output:
            'logs/{sample}/{sample}.sorted_fastqc.zip'
        params:
            out = 'logs/{sample}'
        threads:
            4
        shell:
            'fastqc -t {threads} -o {params.out} {input.bam}'
else:
    rule qc_fastq_fastqc:
        input:
            fastq = joined_pe
        output:
            'logs/{sample}/{sample}.sorted_fastqc.zip'
        params:
            out = 'logs/{sample}'
        threads:
            4
        shell:
            'fastqc -t {threads} -o {params.out} {input.bam}'
