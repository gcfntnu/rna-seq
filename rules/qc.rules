#-*- mode: snakemake -*-
"""
Snakemake rules for quality control of rna-seq.
"""

QC_INTERIM = join(INTERIM_DIR, 'rnaseq', 'qc')
QC_PROCESSED = join(PROCESSED_DIR, 'rnaseq', 'qc')

extra_conf_fn = srcdir('qc.config')
if os.path.exists(extra_conf_fn):
    with open(extra_conf_fn) as fh:
        c  = yaml.load(fh) or {}
        update_config2(config, c)      
include:
    'qc/rseqc.rules'
include:
    'qc/picard.rules'
include:
    'qc/fastqc.rules'
include:
    'qc/preseq.rules'
include:
    'qc/qort.rules'
include:
    'qc/deeptools.rules'

rule qc_bam:
    input:
       expand('logs/{sample}/{sample}.readdist.txt', sample=SAMPLES),
       expand('logs/{sample}/{sample}.junctionSaturation_plot.r', sample=SAMPLES),
       expand('logs/{sample}/{sample}.ccurve.txt', sample=SAMPLES),
       expand('logs/{sample}/{sample}.rnaseq.metrics', sample=SAMPLES)
       
include:
    'qc/multiqc.rules'
